<!DOCTYPE html>
<html dir="ltr" mozdisallowselectionprint>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <meta name="google" content="notranslate" />
    <title>PDF.js Viewer</title>

    <!-- L10N -->
    <link rel="resource" type="application/l10n" href="locale/locale.json" />

    <!-- PDF.js -->
    <script src="pdf.mjs" type="module"></script>

    <script type="module">
      import * as pdfjsLib from "./pdf.mjs";

      // Ajusta o worker corretamente
      pdfjsLib.GlobalWorkerOptions.workerSrc = "./pdf.worker.mjs";

      // Função para capturar ?file=
      function getPDFURL() {
        const params = new URLSearchParams(window.location.search);
        const file = params.get("file");
        return file ? file : "";
      }

      // Envia o arquivo para o viewer
      window.defaultViewerParams = {
        file: getPDFURL(),
      };
    </script>

    <link rel="stylesheet" href="viewer.css" />

    <script src="viewer.mjs" type="module"></script>
  </head>

  <body tabindex="0">
    <div id="outerContainer">
      <span id="viewer-alert" class="visuallyHidden" role="alert"></span>

      <div id="sidebarContainer">
        <div id="toolbarSidebar" class="toolbarHorizontalGroup">
          <div id="toolbarSidebarLeft">
            <div
              id="sidebarViewButtons"
              class="toolbarHorizontalGroup toggled"
              role="radiogroup"
            >
              <button
                id="viewThumbnail"
                class="toolbarButton toggled"
                type="button"
                tabindex="0"
                data-l10n-id="pdfjs-thumbs-button"
                role="radio"
                aria-checked="true"
                aria-controls="thumbnailView"
              >
                Miniaturas
              </button>
              <button
                id="viewOutline"
                class="toolbarButton"
                type="button"
                tabindex="0"
                data-l10n-id="pdfjs-document-outline-button"
                role="radio"
                aria-controls="outlineView"
              >
                Índice
              </button>
            </div>
          </div>
        </div>

        <div id="sidebarContent">
          <div id="thumbnailView"></div>
          <div id="outlineView" class="hidden"></div>
        </div>

        <div id="sidebarResizer"></div>
      </div>

      <div id="mainContainer">
        <div class="toolbar">
          <div id="toolbarContainer">
            <div id="toolbarViewer" class="toolbarHorizontalGroup">
              <div id="toolbarViewerLeft" class="toolbarHorizontalGroup">
                <button
                  id="previous"
                  class="toolbarButton"
                  type="button"
                  tabindex="0"
                >
                  ◀
                </button>
                <button
                  id="next"
                  class="toolbarButton"
                  type="button"
                  tabindex="0"
                >
                  ▶
                </button>

                <span class="loadingInput start toolbarHorizontalGroup">
                  <input
                    type="number"
                    id="pageNumber"
                    class="toolbarField"
                    value="1"
                    min="1"
                  />
                </span>

                <span id="numPages" class="toolbarLabel"></span>
              </div>

              <div id="toolbarViewerMiddle" class="toolbarHorizontalGroup">
                <button id="zoomOutButton" class="toolbarButton">−</button>
                <button id="zoomInButton" class="toolbarButton">+</button>
              </div>

              <div id="toolbarViewerRight" class="toolbarHorizontalGroup">
                <button id="downloadButton" class="toolbarButton">
                  Baixar
                </button>
              </div>
            </div>

            <div id="loadingBar">
              <div class="progress">
                <div class="glimmer"></div>
              </div>
            </div>
          </div>
        </div>

        <div id="viewerContainer" tabindex="0">
          <div id="viewer" class="pdfViewer"></div>
        </div>
      </div>
    </div>

    <div id="printContainer"></div>
  </body>
</html>
